<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Audio de G√™nesis 1</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 2rem; 
      max-width: 800px; 
      margin: auto; 
      line-height: 1.6;
    }
    h1 {
      text-align: center; 
      color: #2c3e50; 
      margin-bottom: 1.5rem;
      font-size: 2.2rem;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .verse { 
      background: #fff; 
      border-radius: 12px; 
      box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
      padding: 1.5rem; 
      margin-bottom: 1.8rem; 
      transition: transform 0.3s ease;
    }
    .verse:hover {
      transform: translateY(-3px);
    }
    .word { 
      transition: all 0.3s ease; 
      cursor: pointer; 
      padding: 2px 4px;
      border-radius: 3px;
    }
    .word:hover {
      background-color: #f0f7ff;
    }
    .highlight { 
      color: #e74c3c; 
      font-weight: bold; 
      background-color: #fff4f2;
      padding: 2px 4px;
      border-radius: 3px;
    }
    .controls button { 
      margin-right: 0.7rem; 
      margin-top: 0.7rem; 
      padding: 0.6rem 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    .global-controls { 
      text-align: center; 
      margin-bottom: 2rem; 
      background: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);
      padding: 1.2rem; 
      border-radius: 12px; 
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      position: sticky; 
      top: 15px; 
      z-index: 999; 
    }
    .global-controls button { 
      color: white; 
      margin: 0 0.7rem; 
      padding: 0.8rem 1.5rem; 
      border: none; 
      border-radius: 8px; 
      cursor: pointer; 
      font-size: 1rem;
      font-weight: 600;
      box-shadow: 0 3px 6px rgba(0,0,0,0.16);
      transition: all 0.3s ease;
    }
    #playAllEN { 
      background: linear-gradient(to right, #8e44ad 0%, #9b59b6 100%);
    }
    #playAllPT { 
      background: linear-gradient(to right, #27ae60 0%, #2ecc71 100%);
    }
    #stopAll { 
      background: linear-gradient(to right, #e74c3c 0%, #c0392b 100%);
    }
    .global-controls button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(0,0,0,0.2);
    }
    .repeat-active { 
      background-color: #ffb74d !important; 
      color: #000 !important; 
    }
    .ref-title { 
      font-size: 1.1rem; 
      color: #8e44ad; 
      margin-top: 0;
      margin-bottom: 1rem;
      font-weight: 600;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 0.5rem;
    }
    .bold-paragraph { 
      font-weight: bold; 
      color: #2c3e50;
    }
    .language-toggle {
      background-color: #3498db !important;
      color: white !important;
    }
    .play-button {
      background-color: #2ecc71 !important;
      color: white !important;
    }
    .pause-button {
      background-color: #f39c12 !important;
      color: white !important;
    }
    .repeat-button {
      background-color: #9b59b6 !important;
      color: white !important;
    }
    footer {
      text-align: center;
      margin-top: 2rem;
      color: #7f8c8d;
      font-size: 0.9rem;
    }
    .playing-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: #e74c3c;
      margin-right: 8px;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(0.95); opacity: 0.7; }
      50% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(0.95); opacity: 0.7; }
    }
  </style>
</head>
<body>
  <h1>
    üìñ G√™nesis 1 ‚Äî Ingl√™s e Portugu√™s
  </h1>

  <div class="global-controls">
    <button id="playAllEN">‚ñ∂Ô∏è Ouvir Tudo (EN)</button>
    <button id="playAllPT">‚ñ∂Ô∏è Ouvir Tudo (PT)</button>
    <button id="stopAll">‚èπÔ∏è Parar Tudo</button>
  </div>

  <div id="container"></div>

  <footer>
    <p>Desenvolvido para estudo das Escrituras ‚Ä¢ Todos os direitos reservados</p>
  </footer>

  <script>
    const verses = [
      
  {
    "ref": "G√™nesis 1:1",
    "enText": "iiiiiIn the beginning God created the heavens and the earth.",
    "ptText": "No princ√≠pio Deus criou os c√©us e a terra.",
    "enFile": "genesis-1-1-en.mp3",
    "ptFile": "genesis-1-1-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:2",
    "enText": "Now the earth was formless and desolate, and there was darkness upon the surface of the watery deep, and God‚Äôs active force was moving about over the surface of the waters.",
    "ptText": "A terra era vazia e deserta, e havia escurid√£o sobre as √°guas profundas; e a for√ßa ativa de Deus movia-se sobre as √°guas.",
    "enFile": "genesis-1-2-kj-en.mp3",
    "ptFile": "genesis-1-2-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:3",
    "enText": "And God said, Let there be light: and there was light.",
    "ptText": "Deus disse: Que haja luz; e houve luz.",
    "enFile": "genesis-1-3-kj-en.mp3",
    "ptFile": "genesis-1-3-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:4",
    "enText": "And God saw the light, that it was good: and God divided the light from the darkness.",
    "ptText": "Deus viu a luz, que era boa; e Deus separou a luz das trevas.",
    "enFile": "genesis-1-4-kj-en.mp3",
    "ptFile": "genesis-1-4-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:5",
    "enText": "And God called the light Day, and the darkness he called Night. And the evening and the morning were the first day.",
    "ptText": "Deus chamou a luz de Dia, e as trevas de Noite. Houve a tarde e a manh√£, o primeiro dia.",
    "enFile": "genesis-1-5-kj-en.mp3",
    "ptFile": "genesis-1-5-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:6",
    "enText": "And God said, Let there be a firmament in the midst of the waters, and let it divide the waters from the waters.",
    "ptText": "Deus disse: Haja um firmamento no meio das √°guas, para separar √°guas de √°guas.",
    "enFile": "genesis-1-6-kj-en.mp3",
    "ptFile": "genesis-1-6-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:7",
    "enText": "And God made the firmament, and divided the waters which were under the firmament from the waters which were above the firmament: and it was so.",
    "ptText": "Deus fez o firmamento e separou as √°guas que estavam debaixo do firmamento das que estavam sobre ele. E assim foi.",
    "enFile": "genesis-1-7-kj-en.mp3",
    "ptFile": "genesis-1-7-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:8",
    "enText": "And God called the firmament Heaven. And the evening and the morning were the second day.",
    "ptText": "Deus chamou o firmamento de C√©us. Houve a tarde e a manh√£, o segundo dia.",
    "enFile": "genesis-1-8-kj-en.mp3",
    "ptFile": "genesis-1-8-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:9",
    "enText": "And God said, Let the waters under the heaven be gathered together unto one place, and let the dry land appear: and it was so.",
    "ptText": "Deus disse: Ajuntem-se as √°guas debaixo do c√©u num lugar; apare√ßa a terra seca. E assim foi.",
    "enFile": "genesis-1-9-kj-en.mp3",
    "ptFile": "genesis-1-9-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:10",
    "enText": "And God called the dry land Earth; and the gathering together of the waters called he Seas: and God saw that it was good.",
    "ptText": "Deus chamou a terra seca de Terra, e ajuntamento das √°guas de Mares. Deus viu que era bom.",
    "enFile": "genesis-1-10-kj-en.mp3",
    "ptFile": "genesis-1-10-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:11",
    "enText": "And God said, Let the earth bring forth grass, the herb yielding seed, and the fruit tree yielding fruit after his kind, whose seed is in itself, on the earth: and it was so.",
    "ptText": "Deus disse: A terra produza erva, ervas que d√™em sementes e √°rvores com frutos segundo a sua esp√©cie. E assim foi.",
    "enFile": "genesis-1-11-kj-en.mp3",
    "ptFile": "genesis-1-11-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:12",
    "enText": "And the earth brought forth grass, and herb yielding seed after his kind, and the tree yielding fruit, whose seed was in itself, after his kind: and God saw that it was good.",
    "ptText": "A terra produziu ervas com sementes segundo a sua esp√©cie e √°rvores com frutos cuja semente est√° nelas. Deus viu que era bom.",
    "enFile": "genesis-1-12-kj-en.mp3",
    "ptFile": "genesis-1-12-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:13",
    "enText": "And the evening and the morning were the third day.",
    "ptText": "Houve a tarde e a manh√£, o terceiro dia.",
    "enFile": "genesis-1-13-kj-en.mp3",
    "ptFile": "genesis-1-13-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:14",
    "enText": "And God said, Let there be lights in the firmament of the heaven to divide the day from the night; and let them be for signs, and for seasons, and for days, and years.",
    "ptText": "Deus disse: Haja luminares no firmamento do c√©u para separar o dia da noite; sejam para sinais, esta√ß√µes, dias e anos.",
    "enFile": "genesis-1-14-kj-en.mp3",
    "ptFile": "genesis-1-14-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:15",
    "enText": "And let them be for lights in the firmament of the heaven to give light upon the earth: and it was so.",
    "ptText": "Que sejam luminares no firmamento do c√©u para dar luz sobre a terra. E assim foi.",
    "enFile": "genesis-1-15-kj-en.mp3",
    "ptFile": "genesis-1-15-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:16",
    "enText": "And God made two great lights; the greater light to rule the day, and the lesser light to rule the night: he made the stars also.",
    "ptText": "Deus fez dois grandes luminares: o maior para governar o dia, e o menor para governar a noite; fez tamb√©m as estrelas.",
    "enFile": "genesis-1-16-kj-en.mp3",
    "ptFile": "genesis-1-16-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:17",
    "enText": "And God set them in the firmament of the heaven to give light on the earth,",
    "ptText": "E os colocou no firmamento do c√©u para dar luz sobre a terra,",
    "enFile": "genesis-1-17-kj-en.mp3",
    "ptFile": "genesis-1-17-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:18",
    "enText": "And to rule over the day and over the night, and to divide the light from the darkness: and God saw that it was good.",
    "ptText": "Para governar o dia e a noite, e para separar a luz das trevas. Deus viu que era bom.",
    "enFile": "genesis-1-18-kj-en.mp3",
    "ptFile": "genesis-1-18-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:19",
    "enText": "And the evening and the morning were the fourth day.",
    "ptText": "Houve a tarde e a manh√£, o quarto dia.",
    "enFile": "genesis-1-19-kj-en.mp3",
    "ptFile": "genesis-1-19-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:20",
    "enText": "And God said, Let the waters bring forth abundantly the moving creature that hath life, and fowl that may fly above the earth in the open firmament of heaven.",
    "ptText": "Deus disse: Que as √°guas produzam em abund√¢ncia seres viventes, aves que voem sobre a terra, no firmamento do c√©u.",
    "enFile": "genesis-1-20-kj-en.mp3",
    "ptFile": "genesis-1-20-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:21",
    "enText": "And God created great whales, and every living creature that moveth, which the waters brought forth abundantly, after their kind, and every winged fowl after his kind: and God saw that it was good.",
    "ptText": "Deus criou grandes baleias e todas as criaturas viventes que as √°guas produziram em abund√¢ncia, segundo a sua esp√©cie, e todas as aves, segundo a sua esp√©cie. Deus viu que era bom.",
    "enFile": "genesis-1-21-kj-en.mp3",
    "ptFile": "genesis-1-21-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:22",
    "enText": "And God blessed them, saying, Be fruitful, and multiply, and fill the waters in the seas, and let fowl multiply in the earth.",
    "ptText": "Deus os aben√ßoou, dizendo: Frutificai, multiplicai-vos, enchei as √°guas dos mares, e multipliquem-se as aves na terra.",
    "enFile": "genesis-1-22-kj-en.mp3",
    "ptFile": "genesis-1-22-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:23",
    "enText": "And the evening and the morning were the fifth day.",
    "ptText": "Houve a tarde e a manh√£, o quinto dia.",
    "enFile": "genesis-1-23-kj-en.mp3",
    "ptFile": "genesis-1-23-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:24",
    "enText": "And God said, Let the earth bring forth the living creature after his kind, cattle, and creeping thing, and beast of the earth after his kind: and it was so.",
    "ptText": "Deus disse: A terra produza seres viventes segundo a sua esp√©cie, gado, r√©pteis e animais selvagens, segundo a sua esp√©cie. E assim foi.",
    "enFile": "genesis-1-24-kj-en.mp3",
    "ptFile": "genesis-1-24-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:25",
    "enText": "And God made the beast of the earth after his kind, and cattle after their kind, and every thing that creepeth upon the earth after his kind: and God saw that it was good.",
    "ptText": "Deus fez os animais selvagens segundo a sua esp√©cie, o gado segundo a sua esp√©cie, e tudo o que rasteja sobre a terra segundo a sua esp√©cie. Deus viu que era bom.",
    "enFile": "genesis-1-25-kj-en.mp3",
    "ptFile": "genesis-1-25-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:26",
    "enText": "And God said, Let us make man in our image, after our likeness: and let them have dominion over the fish of the sea, and over the fowl of the air, and over the cattle, and over all the earth, and over every creeping thing that creepeth upon the earth.",
    "ptText": "Deus disse: Fa√ßamos o homem √† nossa imagem, conforme a nossa semelhan√ßa, e que tenha dom√≠nio sobre os peixes do mar, as aves do c√©u, o gado, toda a terra e todos os r√©pteis que rastejam sobre a terra.",
    "enFile": "genesis-1-26-kj-en.mp3",
    "ptFile": "genesis-1-26-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:27",
    "enText": "So God created man in his own image, in the image of God created he him; male and female created he them.",
    "ptText": "Assim Deus criou o homem √† sua imagem; √† imagem de Deus o criou; homem e mulher os criou.",
    "enFile": "genesis-1-27-kj-en.mp3",
    "ptFile": "genesis-1-27-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:28",
    "enText": "And God blessed them, and God said unto them, Be fruitful, and multiply, and replenish the earth, and subdue it: and have dominion over the fish of the sea, and over the fowl of the air, and over every living thing that moveth upon the earth.",
    "ptText": "Deus os aben√ßoou e lhes disse: Frutificai, multiplicai-vos, enchei a terra e sujeitai-a; dominai sobre os peixes do mar, as aves do c√©u e todos os seres viventes que se movem sobre a terra.",
    "enFile": "genesis-1-28-kj-en.mp3",
    "ptFile": "genesis-1-28-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:29",
    "enText": "And God said, Behold, I have given you every herb bearing seed, which is upon the face of all the earth, and every tree, in the which is the fruit of a tree yielding seed; to you it shall be for meat.",
    "ptText": "Deus disse: Eis que vos dei toda erva que d√° semente na superf√≠cie de toda a terra, e toda √°rvore com fruto que d√° semente; isso servir√° para alimento.",
    "enFile": "genesis-1-29-kj-en.mp3",
    "ptFile": "genesis-1-29-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:30",
    "enText": "And to every beast of the earth, and to every fowl of the air, and to every thing that creepeth upon the earth, wherein there is life, I have given every green herb for meat: and it was so.",
    "ptText": "A todo animal da terra, a toda ave do c√©u e a todo r√©ptil que tem vida, dei toda erva verde para alimento, e assim foi.",
    "enFile": "genesis-1-30-kj-en.mp3",
    "ptFile": "genesis-1-30-kj-pt.mp3"
  },
  {
    "ref": "G√™nesis 1:31",
    "enText": "And God saw every thing that he had made, and, behold, it was very good. And the evening and the morning were the sixth day.",
    "ptText": "Deus viu tudo o que havia feito, e era muito bom. Houve a tarde e a manh√£, o sexto dia.",
    "enFile": "genesis-1-31-kj-en.mp3",
    "ptFile": "genesis-1-31-kj-pt.mp3"
  }
]
    const container = document.getElementById("container");
    let currentAudio = null;
    let rafId = null;
    let isGlobalPlayAll = false;
    let currentPlayAllLang = null;
    const repeatState = {};

    function renderTextWithSpans(text) {
      return text.split(" ").map(w => `<span class="word">${w}</span>`).join(" ");
    }

    // Fun√ß√£o para exibir mensagem de erro de √°udio
    function showAudioError() {
      Swal.fire({
        icon: 'error',
        title: 'Erro de √Åudio',
        text: 'N√£o foi poss√≠vel carregar o √°udio. Verifique sua conex√£o ou tente novamente mais tarde.',
        confirmButtonText: 'OK'
      });
    }

    verses.forEach((v, i) => {
      const div = document.createElement("div");
      div.className = "verse";
      div.innerHTML = `
        <h2 class="ref-title">${v.ref}</h2>
        <p id="en-${i}">${renderTextWithSpans(v.enText)}</p>
        <div class="controls">
          <button class="language-toggle" onclick="toggleTranslation(${i})">üåê Mostrar Tradu√ß√£o</button>
          <button class="repeat-button" id="repeat-toggle-${i}-en" onclick="toggleRepeat(${i}, 'en', this)">üîÅ Repetir</button>
          <button class="play-button" id="toggle-en-${i}" onclick="playIndividualVerse(${i}, 'en', this)">‚ñ∂Ô∏è Ingl√™s</button>
        </div>
        <div id="pt-wrapper-${i}" style="display:none;">
          <p id="pt-${i}">${renderTextWithSpans(v.ptText)}</p>
          <div class="controls">
            <button class="repeat-button" id="repeat-toggle-${i}-pt" onclick="toggleRepeat(${i}, 'pt', this)">üîÅ Repetir</button>
            <button class="play-button" id="toggle-pt-${i}" onclick="playIndividualVerse(${i}, 'pt', this)">‚ñ∂Ô∏è Portugu√™s</button>
          </div>
        </div>
        <audio id="audio-en-${i}" onerror="showAudioError()">
          <source src="${v.enFile}" type="audio/mpeg">
          Seu navegador n√£o suporta o elemento de √°udio.
        </audio>
        <audio id="audio-pt-${i}" onerror="showAudioError()">
          <source src="${v.ptFile}" type="audio/mpeg">
          Seu navegador n√£o suporta o elemento de √°udio.
        </audio>
      `;
      container.appendChild(div);
    });

    function toggleRepeat(index, lang, btn) {
      const key = `${lang}-${index}`;
      repeatState[key] = !repeatState[key];
      btn.classList.toggle('repeat-active', repeatState[key]);
      btn.textContent = repeatState[key] ? 'üîÅ Repetindo' : 'üîÅ Repetir';
    }

    // Fun√ß√£o para tocar vers√≠culos individuais
    function playIndividualVerse(index, lang, btn) {
      // Verifica se o Play All est√° ativo e mostra alerta se estiver
      if (isGlobalPlayAll) {
        Swal.fire({
          icon: 'info',
          title: 'Aten√ß√£o',
          text: 'Voc√™ est√° em Play All. Se quiser ouvir um vers√≠culo individual, primeiro clique em Stop.',
          confirmButtonText: 'OK'
        });
        return;
      }

      playVerse(index, lang, btn);
    }

    // Fun√ß√£o principal para tocar √°udio
    function playVerse(index, lang, btn) {
      const audio = document.getElementById(`audio-${lang}-${index}`);
      const paragraph = document.getElementById(`${lang}-${index}`);
      const words = paragraph.querySelectorAll(".word");

      // Se j√° est√° tocando, pausa
      if (!audio.paused) {
        audio.pause();
        updateButtonState(btn, lang, false);
        paragraph.classList.remove("bold-paragraph");
        cancelAnimationFrame(rafId);
        return;
      }

      // Para qualquer √°udio que esteja tocando atualmente
      if (currentAudio && currentAudio !== audio) {
        currentAudio.pause();
        const allButtons = document.querySelectorAll('.play-button');
        allButtons.forEach(b => {
          if (b.textContent.includes('‚è∏Ô∏è')) {
            updateButtonState(b, lang, false);
          }
        });
      }

      // Configura os eventos de clique nas palavras
      words.forEach((word, wi) => {
        word.onclick = () => {
          if (audio.duration > 0 && !isNaN(audio.duration)) {
            audio.currentTime = (wi / words.length) * audio.duration;
            if (audio.paused) {
              audio.play().catch(e => console.error("Erro ao reproduzir √°udio:", e));
            }
          }
        };
      });

      // Tenta reproduzir o √°udio
      audio.play().then(() => {
        updateButtonState(btn, lang, true);
        paragraph.classList.add("bold-paragraph");
        syncWords(audio, words);

        // Configura o evento de t√©rmino
        audio.onended = () => {
          const key = `${lang}-${index}`;
          if (repeatState[key]) {
            audio.currentTime = 0;
            audio.play().catch(e => console.error("Erro ao reproduzir √°udio:", e));
            return;
          }
          cancelAnimationFrame(rafId);
          words.forEach(w => w.classList.remove("highlight"));
          paragraph.classList.remove("bold-paragraph");
          updateButtonState(btn, lang, false);
        };

        currentAudio = audio;
      }).catch(error => {
        console.error("Erro ao reproduzir √°udio:", error);
        showAudioError();
        updateButtonState(btn, lang, false);
      });
    }

    // Fun√ß√£o para atualizar o estado dos bot√µes
    function updateButtonState(btn, lang, isPlaying) {
      if (isPlaying) {
        btn.textContent = lang === 'en' ? "‚è∏Ô∏è Ingl√™s" : "‚è∏Ô∏è Portugu√™s";
        btn.classList.remove('play-button');
        btn.classList.add('pause-button');
      } else {
        btn.textContent = lang === 'en' ? "‚ñ∂Ô∏è Ingl√™s" : "‚ñ∂Ô∏è Portugu√™s";
        btn.classList.remove('pause-button');
        btn.classList.add('play-button');
      }
    }

    function stopAllAudio() {
      // Para todos os √°udios
      verses.forEach((_, i) => {
        // Ingl√™s
        const enAudio = document.getElementById(`audio-en-${i}`);
        enAudio.pause();
        enAudio.currentTime = 0;
        updateButtonState(document.getElementById(`toggle-en-${i}`), 'en', false);
        document.getElementById(`en-${i}`).classList.remove("bold-paragraph");

        // Portugu√™s
        const ptAudio = document.getElementById(`audio-pt-${i}`);
        ptAudio.pause();
        ptAudio.currentTime = 0;
        updateButtonState(document.getElementById(`toggle-pt-${i}`), 'pt', false);
        document.getElementById(`pt-${i}`).classList.remove("bold-paragraph");
      });

      // Limpa a anima√ß√£o
      cancelAnimationFrame(rafId);
      
      // Reseta as flags
      isGlobalPlayAll = false;
      currentPlayAllLang = null;
      
      // Reabilita os bot√µes
      document.getElementById("playAllEN").disabled = false;
      document.getElementById("playAllPT").disabled = false;
      document.getElementById("playAllEN").textContent = "‚ñ∂Ô∏è Ouvir Tudo (EN)";
      document.getElementById("playAllPT").textContent = "‚ñ∂Ô∏è Ouvir Tudo (PT)";
    }

    function toggleTranslation(index) {
      const wrapper = document.getElementById(`pt-wrapper-${index}`);
      const btn = document.querySelector(`button[onclick="toggleTranslation(${index})"]`);
      
      if (wrapper.style.display === "none") {
        wrapper.style.display = "block";
        btn.textContent = "üåê Ocultar Tradu√ß√£o";
      } else {
        wrapper.style.display = "none";
        btn.textContent = "üåê Mostrar Tradu√ß√£o";
      }
    }

    function syncWords(audio, words) {
      function step() {
        if (!audio.paused && audio.duration > 0 && !isNaN(audio.duration)) {
          const progress = audio.currentTime / audio.duration;
          const wordIndex = Math.floor(progress * words.length);
          words.forEach((w, i) => w.classList.toggle("highlight", i === wordIndex));
        }
        rafId = requestAnimationFrame(step);
      }
      step();
    }

    // Fun√ß√£o para tocar todos os vers√≠culos em uma l√≠ngua
    async function playAll(lang) {
      if (isGlobalPlayAll && currentPlayAllLang === lang) {
        // Se j√° est√° tocando, para a reprodu√ß√£o
        stopAllAudio();
        return;
      }
      
      stopAllAudio();
      isGlobalPlayAll = true;
      currentPlayAllLang = lang;
      
      // Atualiza o texto do bot√£o
      document.getElementById(`playAll${lang.toUpperCase()}`).textContent = "‚è∏Ô∏è Pausar Tudo";
      
      // Desabilita o bot√£o correspondente
      document.getElementById(`playAll${lang === 'en' ? 'PT' : 'EN'}`).disabled = true;
      
      // Para PT, mostra todas as tradu√ß√µes
      if (lang === 'pt') {
        verses.forEach((_, i) => {
          document.getElementById(`pt-wrapper-${i}`).style.display = "block";
          document.querySelector(`button[onclick="toggleTranslation(${i})"]`).textContent = "üåê Ocultar Tradu√ß√£o";
        });
      }

      // Reproduz cada vers√≠culo sequencialmente
      for (let i = 0; i < verses.length; i++) {
        // Se o Play All foi interrompido, para o loop
        if (!isGlobalPlayAll) break;
        
        const btn = document.getElementById(`toggle-${lang}-${i}`);
        const audio = document.getElementById(`audio-${lang}-${i}`);
        const paragraph = document.getElementById(`${lang}-${i}`);
        const words = paragraph.querySelectorAll(".word");
        
        // Prepara o √°udio
        audio.currentTime = 0;
        paragraph.classList.add("bold-paragraph");
        updateButtonState(btn, lang, true);
        
        // Configura os eventos de clique nas palavras
        words.forEach((word, wi) => {
          word.onclick = () => {
            if (audio.duration > 0 && !isNaN(audio.duration)) {
              audio.currentTime = (wi / words.length) * audio.duration;
              if (audio.paused) {
                audio.play().catch(e => console.error("Erro ao reproduzir √°udio:", e));
              }
            }
          };
        });
        
        // Sincroniza as palavras
        syncWords(audio, words);
        
        // Reproduz o √°udio e espera terminar
        try {
          await audio.play();
          
          // Aguarda o t√©rmino do √°udio
          await new Promise(resolve => {
            audio.onended = resolve;
            
            // Verifica se h√° repeti√ß√£o configurada
            const key = `${lang}-${i}`;
            audio.addEventListener('ended', () => {
              if (repeatState[key] && isGlobalPlayAll) {
                audio.currentTime = 0;
                audio.play().catch(e => console.error("Erro ao reproduzir √°udio:", e));
              } else {
                resolve();
              }
            });
          });
        } catch (error) {
          console.error("Erro ao reproduzir √°udio:", error);
          showAudioError();
          break;
        }
        
        // Limpa o destaque
        words.forEach(w => w.classList.remove("highlight"));
        paragraph.classList.remove("bold-paragraph");
        updateButtonState(btn, lang, false);
      }
      
      // Para PT, esconde todas as tradu√ß√µes
      if (lang === 'pt') {
        verses.forEach((_, i) => {
          document.getElementById(`pt-wrapper-${i}`).style.display = "none";
          document.querySelector(`button[onclick="toggleTranslation(${i})"]`).textContent = "üåê Mostrar Tradu√ß√£o";
        });
      }
      
      // Reseta as flags e reabilita os bot√µes
      isGlobalPlayAll = false;
      document.getElementById("playAllEN").disabled = false;
      document.getElementById("playAllPT").disabled = false;
      document.getElementById("playAllEN").textContent = "‚ñ∂Ô∏è Ouvir Tudo (EN)";
      document.getElementById("playAllPT").textContent = "‚ñ∂Ô∏è Ouvir Tudo (PT)";
    }

    // Configura os eventos dos bot√µes de Play All
    document.getElementById("playAllEN").addEventListener("click", () => playAll('en'));
    document.getElementById("playAllPT").addEventListener("click", () => playAll('pt'));
    document.getElementById("stopAll").addEventListener("click", stopAllAudio);
  </script>
</body>
</html>
